import { writeFile } from "fs/promises";

const wcagUrl = "https://www.w3.org/WAI/WCAG22/wcag.json";

const wcag22 = await fetch(wcagUrl).then((response) => {
      if (response.status >= 400)
        throw new Error(`HTTP error code received: ${response.status}`);
      return response.json();
    });

const data = wcag22;

/* Prune unneeded fields
for (const principle of data.principles) {
  delete principle.title;
  delete principle.versions;
  for (const guideline of principle.guidelines) {
    delete guideline.alt_id;
    delete guideline.title;
    delete guideline.versions;
    for (const criterion of guideline.successcriteria) {
      delete criterion.alt_id;
      delete criterion.details;
      delete criterion.title;
      delete criterion.techniques;
      delete criterion.versions;
    }
  }
}
*/

await writeFile("_data/wcag-complete.json", JSON.stringify(data, null, "    ") + "\n");
